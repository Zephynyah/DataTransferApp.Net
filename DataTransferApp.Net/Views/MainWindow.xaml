<Window x:Class="DataTransferApp.Net.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="clr-namespace:MaterialDesignThemes.Wpf;assembly=MaterialDesignThemes.Wpf"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DataTransferApp.Net"
        xmlns:helpers="clr-namespace:DataTransferApp.Net.Helpers"
        mc:Ignorable="d"
        Title="Data Transfer Application" 
        Height="1000" Width="1400"
        WindowStartupLocation="CenterScreen"
        Icon="/app.png"
        Background="{StaticResource BackgroundBrush}">
    
    <Window.Resources>
        <!-- Converters -->
        <helpers:InverseBooleanConverter x:Key="InverseBoolConverter"/>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <helpers:StatusToColorConverter x:Key="StatusToColorConverter"/>
        <helpers:FileRowBackgroundConverter x:Key="FileRowBackgroundConverter"/>
        <helpers:FileIconConverter x:Key="FileIconConverter"/>
        <helpers:AuditStatusToBrushConverter x:Key="AuditStatusToBrushConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource DarkBrush}" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Image Source="/app.png" Width="40" Height="40" Margin="0,0,10,0" VerticalAlignment="Center" Grid.Column="0"/>
                
                <StackPanel Grid.Column="1">
                    <TextBlock Text="Data Transfer Application" FontSize="24" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text=".NET WPF v2.0" FontSize="12" Foreground="{StaticResource LightBrush}"/>
                </StackPanel>

                <Button Grid.Column="2" 
                        Command="{Binding ViewTransferHistoryCommand}"
                        ToolTip="View Transfer History"
                        Background="Transparent" 
                        BorderBrush="{StaticResource SecondaryBrush}" 
                        BorderThickness="1"
                        Width="40"
                        Height="40"
                        Cursor="Hand"
                        Padding="8"
                        Margin="0,0,10,0"
                        VerticalAlignment="Center">
                    <Button.Content>
                        <Path Data="{StaticResource ClockIconGeometry}" Fill="White" Stretch="Uniform" Height="20" Width="20"/>
                    </Button.Content>
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" 
                                                BorderBrush="{TemplateBinding BorderBrush}" 
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="4">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource SecondaryBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
                
                <Button Grid.Column="4" 
                        Command="{Binding OpenSettingsCommand}"
                        ToolTip="Settings"
                        Background="Transparent" 
                        BorderBrush="{StaticResource SecondaryBrush}" 
                        BorderThickness="1"
                        Width="40"
                        Height="40"
                        Cursor="Hand"
                        Padding="8"
                        VerticalAlignment="Center">
                    <Button.Content>
                        <Path Data="{StaticResource SettingsIconGeometry}" Fill="White" Stretch="Uniform" Height="20" Width="20"/>
                    </Button.Content>
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" 
                                                BorderBrush="{TemplateBinding BorderBrush}" 
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="4">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource SecondaryBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>
        
        <!-- Statistics -->
        <Border Grid.Row="1" Background="White" BorderBrush="{StaticResource LightBrush}" BorderThickness="0,0,0,1" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0"  Orientation="Horizontal">
                    <TextBlock Text="Total: " FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding TotalFolders}" Foreground="{StaticResource PrimaryBrush}" FontWeight="Bold" Margin="0,0,20,0"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="Ready: " FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding ReadyFolders}" Foreground="{StaticResource SuccessBrush}" FontWeight="Bold" Margin="0,0,20,0"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock Text="Failed: " FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding FailedFolders}" Foreground="{StaticResource DangerBrush}" FontWeight="Bold" Margin="0,0,20,0"/>
                </StackPanel>

                <StackPanel Grid.Column="3" Orientation="Horizontal">
                    <TextBlock Text="Transferred: " FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding TransferredCount}" Foreground="{StaticResource PrimaryBrush}" FontWeight="Bold" Margin="0,0,20,0"/>
                </StackPanel>

                <StackPanel Grid.Column="4" Orientation="Horizontal"> 
                    <TextBlock Text="Size: " FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding TotalSize}" Foreground="{StaticResource PrimaryBrush}" FontWeight="Bold"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Main Content -->
        <Grid Grid.Row="2" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Panel -->
            <Border Grid.Column="0" Background="White" BorderBrush="{StaticResource LightBrush}" BorderThickness="1" Margin="0,0,5,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                     <Border Grid.Row="0" Background="{StaticResource LightBackgroundBrush}" Padding="10" BorderBrush="{StaticResource LightBrush}" BorderThickness="0,0,0,1" Height="40">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Path Data="{StaticResource DropboxIconGeometry}" Width="16" Height="16" Grid.Column="0"  Stretch="Uniform" Margin="0,0,10,0" Fill="{StaticResource SecondaryBrush}"/>
                            <TextBlock Text="Dropbox Folders" FontWeight="SemiBold" FontSize="14" Grid.Column="1" Margin="0,0,10,0" Padding="0"/>
                            <Button Style="{StaticResource IconButtonStyle}" Grid.Column="2"  Command="{Binding LoadDataCommand}" IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBoolConverter}}" ToolTip="Refresh List">
                                <Path Data="{StaticResource RefreshIconGeometry}" Fill="{StaticResource SecondaryBrush}" Width="14" Height="14" Stretch="Uniform"/>
                            </Button>
                        </Grid>
                    </Border>
                    
                    <ListBox Grid.Row="1" 
                             ItemsSource="{Binding FolderList}" 
                             SelectedItem="{Binding SelectedFolder, Mode=TwoWay}"
                             BorderBrush="{StaticResource LightBrush}" 
                             BorderThickness="0,0,0,1">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="5"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Status Indicator Bar -->
                                    <Border Grid.Column="0" 
                                            Background="{Binding AuditStatus, Converter={StaticResource AuditStatusToBrushConverter}}"
                                            Margin="0,0,5,0"/>
                                    
                                    <!-- Folder Name -->
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding FolderName}" 
                                               TextWrapping="Wrap"/>
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    
                    <StackPanel Grid.Row="2" Margin="10,5">

                        <Button Style="{StaticResource ButtonStyle}" 
                                Command="{Binding AuditAllFoldersCommand}"
                                IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBoolConverter}}">
                            <StackPanel Orientation="Horizontal">
                                <Path Data="{StaticResource SearchIconGeometry}" Fill="White" Width="14" Height="14" Stretch="Uniform" Margin="0,0,5,0"/>
                                <TextBlock Text="Audit All" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource SuccessButtonStyle}" 
                                Command="{Binding TransferAllFoldersCommand}"
                                IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBoolConverter}}">
                            <StackPanel Orientation="Horizontal">
                                <Path Data="{StaticResource TransferIconGeometry}" Fill="White" Width="14" Height="14" Stretch="Uniform" Margin="0,0,5,0"/>
                                <TextBlock Text="Transfer All" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Right Panel -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Folder Details -->
                <Border Grid.Row="0" Background="White" BorderBrush="{StaticResource LightBrush}" BorderThickness="1" Padding="15" Margin="0,0,0,10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Row="0" Grid.Column="0">
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="{Binding SelectedFolder.FolderName, TargetNullValue='No folder selected'}" FontSize="16" FontWeight="SemiBold" Margin="0,0,20,0"/>
                                <TextBlock Text="{Binding SelectedFolder.AuditStatus, StringFormat='Status: {0}'}" FontWeight="SemiBold" Foreground="{Binding SelectedFolder.AuditStatus, Converter={StaticResource AuditStatusToBrushConverter}}"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- Audit Summary with Color-Coded Status -->
                        <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,10,0,0">
                            <!-- Naming Audit -->
                            <Border Background="{Binding SelectedFolder.NamingAuditStatus, Converter={StaticResource AuditStatusToBrushConverter}}" 
                                    CornerRadius="3" 
                                    Padding="8,4" 
                                    Margin="0,0,10,0">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="{StaticResource ChecklistIconGeometry}" 
                                          Fill="White" 
                                          Width="14" 
                                          Height="14" 
                                          Stretch="Uniform" 
                                          Margin="0,0,5,0"
                                          VerticalAlignment="Center"/>
                                    <TextBlock Text="Naming: " Foreground="White" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding SelectedFolder.NamingAuditStatus}" Foreground="White" FontWeight="Bold" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Blacklist Audit -->
                            <Border Background="{Binding SelectedFolder.BlacklistAuditStatus, Converter={StaticResource AuditStatusToBrushConverter}}" 
                                    CornerRadius="3" 
                                    Padding="8,4" 
                                    Margin="0,0,10,0">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="{StaticResource BlockIconGeometry}" 
                                          Fill="White" 
                                          Width="14" 
                                          Height="14" 
                                          Stretch="Uniform" 
                                          Margin="0,0,5,0"
                                          VerticalAlignment="Center"/>
                                    <TextBlock Text="Blacklist: " Foreground="White" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding SelectedFolder.BlacklistAuditStatus}" Foreground="White" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding SelectedFolder.BlacklistViolationCount, StringFormat=' ({0})'}" 
                                               Foreground="White" 
                                               FontWeight="Bold"
                                               VerticalAlignment="Center"
                                               Visibility="{Binding SelectedFolder.BlacklistViolationCount, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Compressed Files Audit -->
                            <Border Background="{Binding SelectedFolder.CompressedAuditStatus, Converter={StaticResource AuditStatusToBrushConverter}}" 
                                    CornerRadius="3" 
                                    Padding="8,4">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="{StaticResource PackageIconGeometry}" 
                                          Fill="White" 
                                          Width="14" 
                                          Height="14" 
                                          Stretch="Uniform" 
                                          Margin="0,0,5,0"
                                          VerticalAlignment="Center"/>
                                    <TextBlock Text="Compressed: " Foreground="White" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding SelectedFolder.CompressedAuditStatus}" Foreground="White" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding SelectedFolder.CompressedFileCount, StringFormat=' ({0})'}" 
                                               Foreground="White" 
                                               FontWeight="Bold"
                                               VerticalAlignment="Center"
                                               Visibility="{Binding SelectedFolder.CompressedFileCount, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                        
                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0,10,0,0" HorizontalAlignment="Right">
                            <Button Command="{Binding AuditFolderCommand}"  Style="{StaticResource ButtonStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="{StaticResource SearchIconGeometry}" Fill="White" Width="14" Height="14" Stretch="Uniform" Margin="0,0,10,0"/>
                                    <TextBlock Text="Audit" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Command="{Binding TransferFolderCommand}"  Style="{StaticResource SuccessButtonStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="{StaticResource TransferIconGeometry}" Fill="White" Width="14" Height="14" Stretch="Uniform" Margin="0,0,10,0"/>
                                    <TextBlock Text="Transfer" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Command="{Binding TransferFolderWithOverrideCommand}"  Style="{StaticResource WarningButtonStyle}" ToolTip="Force transfer even if audit failed">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="{StaticResource WarningIconGeometry}" Fill="White" Width="14" Height="14" Stretch="Uniform" Margin="0"/>
                                    <TextBlock Text="Override" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>

                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Height="30">
                            <!-- Destination Label -->
                            <TextBlock Text="Destination:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <!-- Select Drive -->
                            <ComboBox ItemsSource="{Binding RemovableDrives}"  SelectedItem="{Binding SelectedDrive}" DisplayMemberPath="DisplayText" Width="300" Margin="0"/>
                            <!-- Refresh Drives -->
                            <Button  Command="{Binding DetectDrivesCommand}" Style="{StaticResource ButtonStyle}" Margin="10,0,10,0" ToolTip="Detect Drives">
                                 <Path Data="{StaticResource RefreshIconGeometry}" Fill="White" Stretch="Uniform" Width="14" Height="14"/>
                            </Button>
                            <!-- Clear Drive -->
                            <Button Command="{Binding ClearDriveCommand}"  Style="{StaticResource DangerButtonStyle}" Padding="10,5" Margin="0">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="{StaticResource DeleteIconGeometry}" Fill="White" Width="14" Height="14" Stretch="Uniform" Margin="0,0,5,0"/>
                                    <TextBlock Text="Clear Drive" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Files Grid -->
                <Border Grid.Row="1" Background="White" BorderBrush="{StaticResource LightBrush}" BorderThickness="1">
                    <DataGrid ItemsSource="{Binding FileList}" 
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              CanUserSortColumns="True"
                              GridLinesVisibility="Horizontal"
                              AlternationCount="2">
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow" BasedOn="{StaticResource {x:Type DataGridRow}}">
                                <!-- Default: white background -->
                                <Setter Property="Background" Value="White"/>
                                <Style.Triggers>
                                    <!-- Alternating row - only applies if no other conditions are met -->
                                    <Trigger Property="AlternationIndex" Value="1">
                                        <Setter Property="Background" Value="#ECF0F1"/>
                                    </Trigger>
                                    
                                    <!-- Compressed files override alternating rows -->
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding IsCompressed}" Value="True"/>
                                            <Condition Binding="{Binding IsBlacklisted}" Value="False"/>
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Background">
                                            <Setter.Value>
                                                <SolidColorBrush Color="#F1C40F" Opacity="0.25"/>
                                            </Setter.Value>
                                        </Setter>
                                    </MultiDataTrigger>
                                    
                                    <!-- Blacklisted files get highest priority - override everything -->
                                    <DataTrigger Binding="{Binding IsBlacklisted}" Value="True">
                                        <Setter Property="Background">
                                            <Setter.Value>
                                                <SolidColorBrush Color="#E74C3C" Opacity="0.35"/>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <!-- Icon Column -->
                            <DataGridTemplateColumn Header="" Width="30">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Path Data="{Binding Converter={StaticResource FileIconConverter}}" 
                                              Width="16" 
                                              Height="16" 
                                              Stretch="Uniform" 
                                              HorizontalAlignment="Center">
                                            <Path.Style>
                                                <Style TargetType="Path">
                                                    <Setter Property="Fill" Value="#7f8c8d"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsBlacklisted}" Value="True">
                                                            <Setter Property="Fill" Value="#e74c3c"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding IsCompressed}" Value="True">
                                                            <Setter Property="Fill" Value="#f39c12"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Path.Style>
                                        </Path>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="File Name" Binding="{Binding FileName}" Width="2*"/>
                            <DataGridTextColumn Header="Extension" Binding="{Binding Extension}" Width="*"/>
                            <DataGridTextColumn Header="Size" Binding="{Binding SizeFormatted}" Width="*"/>
                            <DataGridTextColumn Header="Modified" Binding="{Binding Modified}" Width="2*"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="*"/>
                            <DataGridTemplateColumn Header="Action" Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Command="{Binding DataContext.ViewFileContentsCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                CommandParameter="{Binding}"
                                                IsEnabled="{Binding IsViewable}"
                                                Margin="5,0"
                                                Padding="5,3"
                                                FontSize="10"
                                                Background="{StaticResource PrimaryBrush}"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand">
                                            <StackPanel Orientation="Horizontal">
                                                <Path Data="{StaticResource ViewIconGeometry}" Fill="White" Width="12" Height="12" Stretch="Uniform" Margin="0,0,3,0"/>
                                                <TextBlock Text="View" VerticalAlignment="Center" FontSize="10"/>
                                            </StackPanel>
                                        </Button>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
                
                <!-- Progress -->
                <Border Grid.Row="2" Background="White" BorderBrush="{StaticResource LightBrush}" BorderThickness="1" Padding="15,10" Margin="0,10,0,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="{Binding ProgressText}" FontWeight="SemiBold"/>
                        <ProgressBar Grid.Row="1" Height="20" Value="{Binding ProgressPercent}" Minimum="0" Maximum="100" Margin="0,5,0,0"/>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
        
         <!-- Status Bar -->
        <Border Grid.Row="3" Background="{StaticResource SecondaryBrush}" Padding="10,5">
            <TextBlock Text="{Binding StatusMessage}" Foreground="White" VerticalAlignment="Center"/>
        </Border>

        <!-- Snackbar Notification Overlay - Non-disruptive -->
        <Border Grid.RowSpan="4"
                Panel.ZIndex="999"
                HorizontalAlignment="Center" 
                VerticalAlignment="Bottom" 
                Margin="0,0,0,50"
                Background="{Binding SnackbarBackground}"
                CornerRadius="4"
                Padding="20,5"
                MinWidth="300"
                MaxWidth="600"
                IsHitTestVisible="False"
                Visibility="{Binding IsSnackbarVisible, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.5" Color="Black"/>
            </Border.Effect>
            <TextBlock Text="{Binding SnackbarMessage}" 
                       Foreground="White" 
                       FontSize="14" 
                       FontWeight="SemiBold"
                       TextWrapping="Wrap"
                       TextAlignment="Center"/>
        </Border>
    </Grid>
</Window>
